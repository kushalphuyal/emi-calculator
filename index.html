<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional EMI Calculator | Kushal Phuyal</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 15px;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            background-color: #fff;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border-radius: 12px;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            font-size: 1.5rem;
            margin-bottom: 25px;
        }
        .user-header {
            text-align: center;
            font-weight: 600;
            color: #6c5ce7;
            margin-bottom: 10px;
        }
        .input-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .input-group {
            display: flex;
            flex-direction: column;
        }
        .input-group label {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        .input-group input {
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            outline: none;
        }
        .btn {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            background-color: #27ae60;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        /* Mobile Summary Fix */
        .summary {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #2980b9;
            margin-top: 25px;
        }
        .summary h3 { margin-top: 0; color: #2980b9; }
        .summary p { margin: 8px 0; display: flex; justify-content: space-between; border-bottom: 1px dashed #ddd; padding-bottom: 5px; }

        .table-wrapper {
            margin-top: 20px;
            overflow-x: auto; /* Horizontal scroll for mobile */
        }
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px; /* Force scroll on small phones */
        }
        th, td {
            border: 1px solid #eee;
            padding: 12px;
            text-align: right;
            font-size: 0.85rem;
        }
        th { background-color: #2980b9; color: white; text-align: center; }
        tr:nth-child(even) { background-color: #fcfcfc; }
    </style>
</head>
<body>

    <div class="user-header">WELCOME - Kushal Phuyal</div>

    <div class="container">
        <h1>Professional EMI Calculator</h1>

        <div class="input-container">
            <div class="input-group">
                <label>Principal Amount (Rs.)</label>
                <input type="number" id="principal" placeholder="Ex: 500000">
            </div>
            <div class="input-group">
                <label>Annual Interest Rate (%)</label>
                <input type="number" id="rate" step="0.01" placeholder="Ex: 12">
            </div>
            <div class="input-group">
                <label>Tenure (Months)</label>
                <input type="number" id="months" placeholder="Ex: 24">
            </div>
        </div>

        <button class="btn" onclick="calculateEMI()">Calculate EMI</button>

        <div id="result-section" style="display:none;">
            <div class="summary" id="summary"></div>
            <div class="table-wrapper" id="tableContainer"></div>
        </div>
    </div>

    <script>
        function calculateEMI() {
            let principalInput = document.getElementById("principal");
            let principal = parseFloat(principalInput.value);
            let rate = parseFloat(document.getElementById("rate").value) / 12 / 100;
            let months = parseInt(document.getElementById("months").value);

            if (!principal || !rate || !months) {
                alert("Please fill all fields correctly.");
                return;
            }

            document.getElementById("result-section").style.display = "block";

            let emi = principal * rate * Math.pow(1 + rate, months) / (Math.pow(1 + rate, months) - 1);
            let totalInterest = emi * months - principal;
            let serviceCharge = principal * 0.013;
            let insuranceCharge = principal * 0.00425 * Math.ceil(months / 12);
            let totalCharges = serviceCharge + insuranceCharge;
            let totalCost = principal + totalInterest + totalCharges;

            // Summary UI
            document.getElementById("summary").innerHTML = `
                <h3>Results</h3>
                <p><span>Monthly EMI:</span> <strong>Rs. ${emi.toFixed(2)}</strong></p>
                <p><span>Total Interest:</span> <strong>Rs. ${totalInterest.toFixed(2)}</strong></p>
                <p><span>Service Charge (1.3%):</span> <strong>Rs. ${serviceCharge.toFixed(2)}</strong></p>
                <p><span>Insurance Charge:</span> <strong>Rs. ${insuranceCharge.toFixed(2)}</strong></p>
                <p><span>Total Cost:</span> <strong>Rs. ${totalCost.toFixed(2)}</strong></p>
            `;

            // Table UI
            let table = `<table><tr><th>No.</th><th>Date</th><th>Principal</th><th>Interest</th><th>Balance</th></tr>`;
            let tempPrincipal = principal;
            let startDate = new Date();

            for (let i = 1; i <= months; i++) {
                let interestPaid = tempPrincipal * rate;
                let principalPaid = emi - interestPaid;
                tempPrincipal -= principalPaid;
                
                let payDate = new Date(startDate);
                payDate.setMonth(payDate.getMonth() + i - 1);

                table += `<tr>
                    <td>${i}</td>
                    <td>${payDate.toISOString().split('T')[0]}</td>
                    <td>${principalPaid.toFixed(2)}</td>
                    <td>${interestPaid.toFixed(2)}</td>
                    <td>${Math.max(0, tempPrincipal).toFixed(2)}</td>
                </tr>`;
            }
            table += `</table>`;
            document.getElementById("tableContainer").innerHTML = table;
        }
    </script>
</body>
</html>
